# SSL/TLS Hardening Configuration
# Generated by httpd cookbook - DO NOT EDIT MANUALLY
# Based on Mozilla SSL Configuration Generator (Modern profile)

# Protocol Support - TLS 1.2 and 1.3 only
SSLProtocol <%= @ssl_protocols %>

# Modern Cipher Suite
SSLCipherSuite <%= @ssl_ciphers %>
SSLHonorCipherOrder <%= @ssl_honor_cipher_order %>

# SSL Session Configuration
SSLSessionTimeout <%= @ssl_session_timeout %>
SSLSessionCache <%= @ssl_session_cache %>
SSLSessionTickets off

<% if @ocsp_stapling %>
# OCSP Stapling
SSLUseStapling on
SSLStaplingResponderTimeout 5
SSLStaplingReturnResponderErrors off
SSLStaplingCache shmcb:/var/run/apache2/ocsp(128000)
<% end %>

<% if @hsts_enabled %>
# HTTP Strict Transport Security (HSTS)
Header always set Strict-Transport-Security "max-age=<%= @hsts_max_age %>; includeSubDomains; preload"
<% end %>

# Security Headers
Header always set X-Content-Type-Options "nosniff"
Header always set X-Frame-Options "SAMEORIGIN"
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"

# Disable SSL Compression (CRIME attack mitigation)
SSLCompression off
